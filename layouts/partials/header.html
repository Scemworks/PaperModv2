{{- /* theme-toggle is enabled */}}
{{- if (not site.Params.disableThemeToggle) }}
{{- /* theme is light */}}
{{- if (eq site.Params.defaultTheme "light") }}
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }
</script>
{{- /* theme is dark */}}
{{- else if (eq site.Params.defaultTheme "dark") }}
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }
</script>
{{- else }}
{{- /* theme is auto */}}
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>
{{- end }}
{{- /* theme-toggle is disabled and theme is auto */}}
{{- else if (and (ne site.Params.defaultTheme "light") (ne site.Params.defaultTheme "dark"))}}
<script>
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>
{{- end }}

<header class="header">
    <nav class="nav">
        <div class="logo">
            {{- $label_text := (site.Params.label.text | default site.Title) }}
            {{- if site.Title }}
            <a href="{{ "" | absLangURL }}" accesskey="h" title="{{ $label_text }} (Alt + H)">
                {{- if site.Params.label.icon }}
                {{- $img := resources.Get site.Params.label.icon }}
                {{- if $img }}
                    {{- $processableFormats := (slice "jpg" "jpeg" "png" "tif" "bmp" "gif") -}}
                    {{- if hugo.IsExtended -}}
                        {{- $processableFormats = $processableFormats | append "webp" -}}
                    {{- end -}}
                    {{- $prod := (hugo.IsProduction | or (eq site.Params.env "production")) }}
                    {{- if and (in $processableFormats $img.MediaType.SubType) (eq $prod true)}}
                        {{- if site.Params.label.iconHeight }}
                            {{- $img = $img.Resize (printf "x%d" site.Params.label.iconHeight) }}
                        {{ else }}
                            {{- $img = $img.Resize "x30" }}
                        {{- end }}
                    {{- end }}
                    <img src="{{ $img.Permalink }}" alt="" aria-label="logo"
                        height="{{- site.Params.label.iconHeight | default "30" -}}">
                {{- else }}
                <img src="{{- site.Params.label.icon | absURL -}}" alt="" aria-label="logo"
                    height="{{- site.Params.label.iconHeight | default "30" -}}">
                {{- end -}}
                {{- else if hasPrefix site.Params.label.iconSVG "<svg" }}
                    {{ site.Params.label.iconSVG | safeHTML }}
                {{- end -}}
                {{- $label_text -}}
            </a>
            {{- end }}
        </div>

        <!-- Hamburger Menu Icon for Mobile -->
        <div class="hamburger-menu">
            <button id="hamburger-toggle" aria-label="Toggle navigation">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
        </div>

        <!-- Mobile Navigation -->
        <ul id="mobile-menu" class="mobile-nav">
            {{- range site.Menus.main }}
            <li>
                <a href="{{ .URL | absLangURL }}" title="{{ .Title | default .Name }}">
                    {{- .Name }}
                </a>
            </li>
            {{- end }}
        </ul>

        <!-- Regular Menu -->
        <ul id="menu">
            {{- range site.Menus.main }}
            <li>
                <a href="{{ .URL | absLangURL }}" title="{{ .Title | default .Name }}">
                    {{- .Name }}
                </a>
            </li>
            {{- end }}
        </ul>
    </nav>
</header>

{{- if (not site.Params.disableThemeToggle) }}
<script>
    document.getElementById('theme-toggle').addEventListener('click', function() {
        if (document.body.classList.contains('dark')) {
            document.body.classList.remove('dark');
            localStorage.setItem('pref-theme', 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem('pref-theme', 'dark');
        }
    });
</script>
{{- end }}

<script>
    document.getElementById('hamburger-toggle').addEventListener('click', function() {
        var menu = document.getElementById('mobile-menu');
        if (menu.style.display === 'block') {
            menu.style.display = 'none';
        } else {
            menu.style.display = 'block';
        }
    });
</script>

<style>
    /* Hamburger menu button */
    .hamburger-menu {
        display: none;
        cursor: pointer;
        width: 30px;
        height: 30px;
        position: absolute;
        top: 20px;
        right: 20px;
    }

    .hamburger-menu .bar {
        width: 25px;
        height: 3px;
        background-color: #333;
        margin: 5px 0;
    }

    /* Mobile navigation menu (hidden by default) */
    .mobile-nav {
        display: none;
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .mobile-nav li {
        padding: 10px;
    }

    .mobile-nav a {
        text-decoration: none;
        color: #333;
    }

    /* Show the hamburger button and hide the regular menu on mobile devices */
    @media (max-width: 768px) {
        .hamburger-menu {
            display: block;
        }

        #menu {
            display: none;
        }
    }
</style>